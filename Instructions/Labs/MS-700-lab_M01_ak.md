# **ラボ 01: Microsoft Teams でのコラボレーションとコミュニケーションの管理**

# **受講生ラボ解答キー**

## **Microsoft 365 ユーザーインターフェイス**

Microsoft クラウドツールの動的な性質により、このトレーニングコンテンツの開発後に行われたユーザーインターフェイス (UI) の変更が発生する可能性があります。これは UI の変更として現れます。

Microsoft World-Wide Learning チームは、そのような変更が通知され次第、このトレーニングコースを更新します。ただし、クラウドの更新の動的な性質により、このトレーニングコンテンツの更新前に UI の変更が発生する可能性があります。

## **ラボシナリオ**

このコースのラボでは、Contoso Ltd. の Teams 管理者である Joni Sherman の役割を担います。パイロットチームメンバーに必要な Teams 管理者ロールが割り当てられていることを確認するよう求められます。

パイロットプロジェクトを開始したばかりで、Teams デスクトップクライアントがプレインストールされた 2 台の仮想マシンと、さまざまなユーザーを持つテナントがあります:

- Joni Sherman (JoniS@&lt;YourTenant&gt;.OnMicrosoft.com) **Teams 管理者**

- Patti Fernandez (PattiF@&lt;YourTenant&gt;.OnMicrosoft.com) **Teams デバイス管理者**

- Allan Deyoung (AllanD@&lt;YourTenant&gt;.OnMicrosoft.com) **Teams コミュニケーションサポートエンジニア**

- Alex Wilber (AlexW@&lt;YourTenant&gt;.OnMicrosoft.com) **カナダからの通常のパイロットユーザー**

- Lynne Robbins (LynneR@&lt;YourTenant&gt;.OnMicrosoft.com) **通常のパイロットユーザー**

- Diego Siciliani (DiegoS@&lt;YourTenant&gt;.OnMicrosoft.com) **通常のパイロットユーザー**

## **目標**

このラボを完了すると、次のことができるようになります:

- ユーザーに Teams 管理者ロールを割り当てる

- ユーザーのライセンス割り当てを確認する

- Teams 管理センターとそのメニューを理解する

- Teams PowerShell モジュールをインストールし、そのコマンドレットを調べる

- M365 管理センターから Microsoft 365 グループを作成する

- Teams デスクトップクライアントを使用して新しいチームを作成する

- Teams Web クライアントを使用して新しいチームを作成する

- 有効期限ポリシーを構成する

- 新しいチームの作成をセキュリティグループのメンバーに制限する

- 名前付けポリシーを作成する

- Teams プレビュー機能へのアクセスを有効にする

## **ラボのセットアップ**

- **推定時間:** 100 分

## **手順**

### **開始する前に**

このコースのラボは、Contoso Ltd. Corporation での Microsoft Teams 展開用に準備されています。Contoso は、Microsoft 365 クラウド専用の展開を実行しています。ラボ環境は特別に設計されています。

#### **1. ラボ仮想マシンにサインインする**

このコースのラボでは、2 台の仮想マシンを使用します:

- Client 1 VM: Microsoft Teams がプレインストールされたスタンドアロンの Windows 10 クライアント仮想マシン

- Client 2 VM: Microsoft Teams がプレインストールされたスタンドアロンの Windows 10 クライアント仮想マシン

**注:** ラボ仮想マシンのサインイン手順は、インストラクターから提供されます。

**重要:** MS-700 ラボの演習は、クラウド専用の展開です。クライアント VM にはローカル管理者アカウントが作成されています。ドメインアカウントではなく、ローカル管理者として VM にログインします。

#### **2. インストールされたアプリケーションを確認する**

VM にサインインしたら、スタートメニューを確認し、次のアプリケーションがインストールされていることを確認します:

- Microsoft Teams

#### **3. Microsoft 365 テナントを確認する**

2 台の VM に加えて、次のハイライトを持つ Microsoft 365 テナントも提供されます:

- Enterprise Mobility + Security E5 を含む Office 365 E5

- 合計 15 ライセンス、15 のうち 5 つが利用可能（10 使用中）

- 1 人のグローバル管理者（MOD Administrator）と 9 人の標準ユーザーが事前に作成されています

- **注:** Microsoft 365 サインイン手順は、インストラクターから提供されます

- グローバル管理者（MOD Administrator）のユーザー名は **admin@&lt;YourTenant&gt;.onmicrosoft.com** です

- **&lt;YourTenant&gt;.onmicrosoft.com** - これは、ラボホスティングプロバイダーによって提供された Microsoft 365 テナントに関連付けられたドメインです。このドメイン名の最初の部分（&lt;YourTenant&gt;）は、ラボホスティングプロバイダーによって割り当てられた一意のテナント ID です

- **重要:** このラボ全体を通して、特定のユーザー名でアプリにサインインするときに **&lt;YourTenant&gt;.onmicrosoft.com** ドメイン名を入力するように求められるため、これは重要です

- たとえば、テナントメールが **admin@contosolab.onmicrosoft.com** の場合、一意のテナントサフィックス ID（&lt;YourTenant&gt;）は **contosolab** です。このドメインを入力する際に Joni としてサインインする場合、JoniS@contosolab.onmicrosoft.com と入力します

- **推奨事項:** このラボで &lt;YourTenant&gt; として言及され、トレーニングプロバイダーから提供される一意のテナントサフィックスを書き留めておく必要があります。しばらくすると、この名前または番号を記憶するようになります

- **WWL テナント - 利用規約**

    インストラクター主導のトレーニング提供の一環としてテナントが提供されている場合、テナントはインストラクター主導のトレーニングでのハンズオンラボをサポートする目的で利用可能であることに注意してください。

    テナントは、ハンズオンラボ以外の目的で共有または使用しないでください。このコースで使用されるテナントはトライアルテナントであり、クラス終了後に使用またはアクセスすることはできず、拡張の対象にもなりません。

    テナントを有料サブスクリプションに変換してはなりません。このコースの一環として取得されたテナントは Microsoft Corporation の所有物であり、当社はいつでもアクセスして再取得する権利を留保します。


### **演習 1: Teams 管理者ロールとライセンスを準備する**

最初の演習では、必要な管理者ロールをユーザーに割り当て、Teams ライセンスのライセンス割り当てを確認します。これらのタスクを実行するには、既定のテナントグローバル管理者を使用します。

#### **タスク 1 - ユーザーに Teams 管理者ロールを割り当てる**

このタスクでは、既定のグローバル管理者を使用して Microsoft 365 管理センターにサインインし、複数の Teams 管理者ロールをさまざまなユーザーに割り当てます。このタスクは、後のタスクと演習にとって重要です。

1. **MOD Administrator** として Microsoft 365 管理センター (https://admin.microsoft.com/) を参照します。

	- 提供された資格情報を使用して **Client 1 VM** に接続します。

	- **Microsoft Edge** を開き、グローバル管理者資格情報（**MOD Administrator**）を使用して [**https://admin.microsoft.com/**](https://admin.microsoft.com/) の **Microsoft 365 管理センター**を参照します。

2. **Joni Sherman** に **Teams 管理者**ロールを割り当てる

	- 左上のナビゲーションメニューを選択し、その下の **ユーザー**と **アクティブなユーザー**を選択します。

	- アクティブなユーザーのリストで、**Joni Sherman** を検索して選択し、右側の設定ペインを開きます。

	- [アカウント] タブの下の設定で、**ロールの管理**を選択します。

	- **管理者ロールの管理**ペインで、**管理センターへのアクセス**を選択し、下にスクロールして **カテゴリ別にすべて表示**を展開し、使用可能なすべてのロールを表示します。

	- **Teams 管理者**チェックボックスを選択してから、**変更の保存**を選択します。ペインの上部に「**管理者ロールが更新されました**」というメッセージが表示され、更新が確認されます。**管理者ロールの管理**ペインを閉じます。

3. **Patti Fernandez** に **Teams デバイス管理者**ロールを割り当てる

	- 上記と同じ手順を繰り返し、**アクティブ���ユーザー**リストで **Patti Fernandez** を検索して選択し、**Patti Fernandez** に **Teams デバイス管理者**ロールを割り当てます。

4. **Allan Deyoung** に **Teams コミュニケーションサポートエンジニア**ロールを割り当てる

	- 上記と同じ手順を繰り返し、**Allan Deyoung** に **Teams コミュニケーションサポートエンジニア**ロールを割り当てます。

これで、Teams 管理者ロールが正常に割り当てられました。

- Teams 管理者: Joni Sherman

- Teams デバイス管理者: Patti Fernandez

- Teams コミュニケーションサポートエンジニア: Allan Deyoung

次のタスクに進みます。

#### **タスク 2 – ユーザーのライセンス割り当てを確認する**

このタスクでは、パイロットに参加しているすべてのユーザーのライセンス割り当てを確認します。タスクの最後に、すべてのパイロットユーザーが正しくライセンスされていることを確認し、Alex Wilber の場所をカナダに変更します。

1. **Client 1 VM** に接続し、**MOD Administrator** として Microsoft 365 管理センター (https://admin.microsoft.com/) を参照します。

2. **Alex Wilber の**場所を**カナダ**に更新する

	- **ユーザー** > **アクティブなユーザー**ページで、**Alex Wilber** の名前を選択します。

	- **ライセンスとアプリ**タブを選択します。

	- **場所の選択**の下のドロップダウンメニューを選択し、**カナダ**に更新します。

	- **変更の保存**を選択します。

3. **Alex Wilber の**ライセンスを確認する

	- 同じタブの **ライセンス**セクションで、**Microsoft 365 E5** が選択されていることを確認します。

	- **アプリ**を選択してすべてのライセンスを展開します。

	- すべてのアプリのリストを下にスクロールし、**Microsoft Teams** が選択されていることを確認します。

4. 同じ手順を繰り返して、他のユーザーのライセンスを確認できます。場所は変更しないでください。

パイロットに参加しているすべてのユーザーが Teams ライセンスを所有しており、Teams の使用を開始する準備ができていることを正常に検証しました。また、Alex Wilber の場所をカナダに変更しました。これは、後の演習でカナダの呼び出しプランをテストするために必要です。

最初の演習が完了しました。次の演習に進むことができます。

### **演習 2: Teams 管理ツールを調べる**

この演習では、Teams 管理センターを調べ、Teams PowerShell モジュールをインストールします。これは、テナントでチーム、ポリシーパッケージ、通話機能、その他すべての Teams 設定を管理するために必要です。

これらのタスクを実行するには、Joni Sherman のアカウント (JoniS@_&lt;YourTenant&gt;_.onmicrosoft.com) を使用します。

#### **タスク 1 - Teams 管理センターを調べる**

Teams 管理センターで Teams を管理するための使用可能な設定を確認します。

1. **Client 1 VM** に接続し、**Joni Sherman** (JoniS@&lt;YourTenant&gt;.onmicrosoft.com) として Teams 管理センター (https://admin.teams.microsoft.com) を参照します。

	**注:** 別の資格情報でログインするには、Microsoft Edge の **InPrivate ウィンドウ**を使用できます。

2. Teams 管理センターの左側のナビゲーションで、**Teams** > **チームを管理**を選択します。作成されると、組織内のチームが表示されます。

3. Teams 管理センターの左側のナビゲーションで、**Teams** > **Teams ポリシー**を選択します。**グローバル（組織全体の既定）**という名前の既定の Teams ポリシーが表示されます。

他の設定を調べて、Teams 管理センターのさまざまなコントロールに慣れることができます。

テナントでチームを管理し、ポリシーを構成するために、Teams 管理センターから使用可能ないくつかのメニューを正常に調べました。

#### **タスク 2 - Teams PowerShell モジュールをインストールして調べる**

このタスクでは、Teams PowerShell モジュールをインストールしてテナントに接続し、使用可能なコマンドレットと機能を調べてテナントを管理します。Teams PowerShell モジュールは、クライアント PC にインストールできます。

**注意してください:** Microsoft PowerShell は間もなく非推奨となり、Microsoft Graph PowerShell が使用されるようになります。したがって、このタスクを完了するために、PowerShell と Microsoft Graph PowerShell の両方のコマンドが提供されています。

このタスクの Microsoft Graph PowerShell コマンドは、Microsoft PowerShell コマンドの後に記載されています。

1. 提供された VM 資格情報を使用して **Client 1 VM** に接続します。

2. 管理者として **Windows PowerShell** を開きます。

	- **スタート**を選択し、**Windows PowerShell (Admin)** を検索して、右クリックして **管理者として実行**を選択します。注: **Client 1VM** のパスワードを入力するよう求められる場合があります

	- **ユーザーアカウント制御**ウィンドウを **はい**で確認します。

3. **Microsoft Teams PowerShell モジュール**をインストールする

	- PowerShell ウィンドウで、次のコマンドレットを入力して **Enter** キーを押します:

		- Microsoft PowerShell: Install-Module -Name MicrosoftTeams
		- Microsoft Graph PowerShell: Install-Module -Name Microsoft.Graph および Install-Module -Name Microsoft.Graph.Beta

	- **Y** を入力して **Enter** キーを 2 回押し、NuGet プロバイダーと信頼されていないリポジトリのインストールを確認します。

4. テナントに接続します。

	- PowerShell ウィンドウで次のコマンドレットを入力し、**Enter** キーを押します:

		- Microsoft PowerShell: Connect-MicrosoftTeams
		- Microsoft Graph PowerShell: Connect-MgGraph

	- サインインウィンドウで、Teams 管理者 - Joni Sherman (JoniS@&lt;YourTenant&gt;.onmicrosoft.com) としてサインインします。

	- サインインが成功すると、サインインしたユーザーとテナントに関するいくつかの情報が表示されます。

5. **Microsoft Teams PowerShell モジュール**を調べる

	- MicrosoftTeams モジュールが正しく読み込まれていることを確認するには、次のコマンドレットを入力して **Enter** キーを押し、使用可能なすべての PowerShell モジュールを表示します:

		- Microsoft PowerShell - ```Get-Module```
		-Microsoft Graph PowerShell - ```Get-Module -Name Microsoft.Graph -ListAvailable``` または ```Get-Module -Name MicrosoftTeams```

		**注**: **Name** 列の左側に、PowerShell モジュールのバージョンが表示されます。

	- MicrosoftTeams モジュールから使用可能な Teams PowerShell コマンドレットの概要を取得するには、次のコマンドレットを入力して **Enter** キーを押します:

		-Microsoft PowerShell - ```Get-Command -Module MicrosoftTeams```
   		-Microsoft Graph PowerShell - ```Get-Command -Module Microsoft.Graph.Teams```

	- Get-Help コマンドレットは、使用可能なコマンドレットを調べるために使用されます。たとえば、PowerShell でチームを作成する方法の詳細を取得するには、次のコマンドレットを入力して **Enter** キーを押します:

		```Get-Help New-Team```

		**注**: ヘルプライブラリを更新するメッセージが表示された場合は、**Y** を入力してください。

	- Microsoft Teams 環境から切断します。

		- Microsoft PowerShell - ```Disconnect-MicrosoftTeams```
		-Microsoft Graph PowerShell - ```Disconnect-MgGraph```

6. PowerShell ウィンドウを閉じて、次のタスクに進みます。

Microsoft Teams PowerShell モジュールを使用して Teams に接続し、使用可能なコマンドレットを調べることに成功しました。

### **演習 3: グループとチームを作成する**

この演習では、Microsoft 365 管理センターから Microsoft 365 グループを作成し、Teams デスクトップクライアントと Web クライアントからチームを作成します。

#### **タスク 1 - Microsoft 365 グループを作成する**

「IT-Department」という名前の新しい Microsoft 365 グループを作成し、パイロットメンバーを追加して、将来のチームとライセンスの基盤として機能させます。

1. **Client 1 VM** に接続し、**Joni Sherman** (JoniS@&lt;YourTenant&gt;.onmicrosoft.com) として **Microsoft 365 管理センター** (https://admin.microsoft.com/) を参照します。

2. Microsoft 365 管理センターで、**Teams とグループ** > **アクティブなチームとグループ**を選択します。

3. **アクティブなチームとグループ**ページで、**+ Microsoft 365 グループを追加**を選択します。

4. 次の情報を使用して**グループの追加**ウィザードに従います:

	- 基本:

		- 名前: **IT-Department**

		- 説明: **IT 部門のすべてのスタッフ**

		- **次へ**を選択

	- 所有者:

		- **+ 所有者の割り当て**を選択

		- **Joni Sherman** を検索して選択

		- **追加(1)** を選択してから、**次へ**を選択します。

	- メンバー:

		- **+ メンバーを追加**を選択し、次のユーザーを追加します:

			- Patti Fernandez

			- Allan Deyoung

			- MOD Administrator

		- **追加(3)** を選択してから、**次へ**を選択します。

	- 設定:

		- グループのメールアドレスに **IT-Department** を入力します。

		- プライバシー: **プライベート**

   		- 秘密度: **なし**

		- **このグループのチームを作成する**のチェックを外します。

		- **次へ**を選択

6. **グループの作成**ボタンを押してから、**閉じる**を押します。
   
7. しばらく待ってから **更新**を選択し、グループが表示されるまで待ちます。**Teams の状態**列に Teams アイコンがないことがわかります。

8. **IT-Department** グループを選択して、設定とメンバーを確認します。

「IT-Department」という名前の新しい Microsoft 365 グループが正常に作成されました。ブラウザーウィンドウを閉じて、次のタスクに進みます。

#### **タスク 2 - デスクトップクライアントを使用して新しいチームを作成する**

Teams のセルフサービス機能をテストするために、このタスクでは、**Alex Wilber** が Teams デスクトップクライアントにサインインし、**Teams Rollout** という名前の新しいチームを作成し、パイロットに参加しているすべてのメンバーを追加します。

1. 提供された資格情報を使用して **Client 2 VM** に接続します。

2. タスクバーの **Teams** アイコンを選択して、Teams デスクトップクライアントを起動します。

3. **「サインイン」** を選択し、**Alex Wilber** (AlexW@&lt;YourTenant&gt;.onmicrosoft.com) としてサインインします。「すべてのアプリにサインインしたままにする」ウィンドウで、**いいえ、このアプリのみにサインインします**を選択します。

	**注**: Alex のパスワードがない場合は、次の手順で Alex のパスワードをリセットできます:
	
	1. **MOD Administrator** として **Microsoft 365 管理センター**にログインします。
	2. **ユーザー &gt; アクティブなユーザー**ページで、**Alex Wilber** の名前を選択します。
	3. 上部から **パスワードのリセット**を選択し、**パスワードを自動的に作成する**を選択し、**ユーザーが最初にサインインするときにパスワードを変更する必要がある**のチェックを外して、**パスワードのリセット**を選択します。
	4. パスワード列の下のパスワードを使用してログインします。

	**注**: 最新の Teams デスクトップクライアントをダウンロードしてインストールする必要がある場合があります。その場合は、**Teams を更新**を選択してインストールガイドラインに従います - **デスクトップ用にダウンロード** > **Teams をダウンロード** > **ダウンロードしたファイルを開いてインストール**を選択します。

4. Teams デスクトップクライアントで、左側のメニューから **Teams** を選択します。

5. **チームを作成** > **最初から** > チーム名 **Teams Rollout** を入力 > **説明**に何でも入力 > チームタイプを**パブリック**に設定 > 最初のチャネルに名前を付けるために **Teams Rollout** と入力 > **作成**を選択します。

6. **Teams Rollout にメンバーを追加**ウィンドウで、次の名前を入力して **追加**を選択します。

	- Joni Sherman

	- Lynne Robbins

	- Diego Siciliani

7. 左隅から **Teams** を選択し、**Teams Rollout** の横にある **...** ボタンをクリック > **チームを管理**します。

8. **メンバー**タブを選択し、**メンバーとゲスト**のドロップダウンを選択し、Joni Sherman までスクロールして、**メンバー**から **所有者**に切り替えます。

Teams デスクトップクライアントから新しいチームを正常に作成し、プロジェクトチームメンバーを追加し、Joni Sherman をチーム所有者にしました。

#### **タスク 3 - Web クライアントを使用して新しいチームを作成する**

このタスクでは、**Lynne Robbins** が Teams Web クライアントを使用して **Sales** という名前の別のチームを作成することで、Teams のセルフサービス機能のテストを続けます。彼女はまた、**Alex Wilber** を新しいチームのメンバーとして追加します。

1. 提供された資格情報を使用して **Client 2 VM** に接続します。

2. [**https://teams.microsoft.com**](https://teams.microsoft.com/) の **Microsoft Teams Web クライアント**を参照し、**Lynne Robbins** (LynneR@&lt;YourTenant&gt;.onmicrosoft.com) としてサインインします。

3. Teams デスクトップアプリをダウンロードするよう求められた場合は、**代わりに Web アプリを使用する**を選択します。「すべてのアプリにサインインしたままにする」ウィンドウで、**いいえ、このアプリのみにサインインします**を選択します。

4. 左側のナビゲーションメニューから **Teams** を選択します。

5. 左上の **+** を選択 >  **チームを作成** >チーム名 **Sales** を入力 > **説明**に何でも入力 > チームタイプを **プライベート**に選択 > 最初のチャネルに名前を付けるために **Sales** を入力 > **作成**を選択します。

6. **Sales にメンバーを追加**ウィンドウで、次の名前を入力して **追加** > **閉じる**を選択します。

	- Alex Wilber

新しく作成されたチームがチームのリストに表示されます。Teams Web クライアントで新しいチームを正常に作成しました。

### **演習 4: Microsoft Teams のライフサイクル管理とガバナンスを実装する**

組織は、Microsoft 365 サービスの採用計画プロセスを開始しました。Teams ガバナンスを計画するために、Teams 管理者ロールが割り当てられています。Teams は Microsoft 365 グループに依存しているため、最初に Microsoft 365 グループのガバナンスを計画する必要があります。

#### タスク 1 - 有効期限ポリシーを作成して割り当てる

組織の要件に基づいて、不要なグループは 90 日後に自動的に削除される必要があります。Teams の有効期限機能を評価するには、90 日後にグループが削除され、所有者がいない場合は Joni Sherman に通知されるグループ有効期限ポリシーを構成します。

1. Client1 VM に接続し、**MOD Administrator** として Entra 管理センター (https://entra.microsoft.com/) を参照します。

2. Contoso の下のメインページで、**グループの表示** > **すべてのグループ**を選択します。

3. **グループ | すべてのグループ**ページで、ナビゲーションメニューの左側の設定の下にある **有効期限**を選択します。

4. **グループ | 有効期限**ページで、次の設定を構成します:

	- **グループの有効期間（日数）**のドロップダウンメニューで、**カスタム**を選択し、テキストボックスに **90** と入力します。

	- **所有者がいないグループのメール連絡先**の右側のテキストボックスに (JoniS@&lt;YourTenant&gt;.onmicrosoft.com) と入力します。

	- **Office 365 グループの有効期限を有効にする**の右側で、**選択済み**を選択します。

	- **+ 追加**を選択して、**グループの選択**ページを開きます。

	- **グループの選択**ページで、テキストボックスに **Teams Rollout** と入力し、グループを選択します。

	- 右側のペインの下部にある **選択**ボタンを使用して、**選択したグループ**にポリシーを適用します。

	- **グループ | 有効期限**ページに戻り、**保存**を選択します。

新しい有効期限ポリシーを正常に作成し、**Teams Rollout** チームが 90 日後に期限切れになるように構成しました。90 日後にチームに所有者がいない場合、Joni Sherman に通知されます。

#### タスク 2 - グループ作成ポリシーを構成する

あなたは Teams 組織の管理者です。どのユーザーが Microsoft 365 グループを作成できるかを制限する必要があります。**GroupCreators** という名前のセキュリティグループを作成し、そのグループのメンバーのみが新しい Microsoft 365 グループを作成できるようにします。

1. **Client 1 VM** に接続し、グローバル管理者 - MOD Administrator(admin@&lt;YourTenant&gt;.onmicrosoft.com) として **Microsoft 365 管理センター** (https://admin.microsoft.com/) を参照します。

2. Microsoft 365 管理センターで、**Teams とグループ** > **アクティブなチームとグループ**を選択します。

3. **アクティブなチームとグループ**ページで、セキュリティグループを作成します。

	- **セキュリティグループ**タブに移動します。
        - **+ セキュリティグループの追加**ボタンを選択します。
          
- 次の情報を入力します:
	- 基本:

		- 名前: **GroupCreators**
		- 説明: **新しいチームの Microsoft 365 グループを作成できるユーザー**
		- **次へ**を選択
    
       - 設定:
                - **次へ**を選択

	- 完了: **グループの作成**を選択してから、**閉じる**を選択します

	- **アクティブなチームとグループ**ページに戻り、**セキュリティグループ**タブを選択し、作成したばかりのセキュリティグループ **GroupCreators** を選択します。

	- **メンバー**タブを選択して、**所有者**と**メンバー**を構成します。

		- 所有者: **すべての所有者を表示して管理**を選択し、**+ 所有者を追加**を選択します。**MOD Administrator** を選択します。

		- メンバー: **すべてのメンバーを表示して管理** > **+ メンバーを追加**を選択し、次のユーザーを追加します:

			- Joni Sherman
			- Alex Wilber

セキュリティグループへの Microsoft 365 グループの作成を制限します。
   
注意してください: Microsoft PowerShell は間もなく非推奨となり、Microsoft Graph PowerShell が使用されるようになります。したがって、このタスクを完了するために、PowerShell と Microsoft Graph PowerShell の両方のコマンドが提供されています。

注意してください: Microsoft Graph PowerShell コマンドは近い将来追加されます。以下にリストされている手順では、引き続き Powershell コマンドを使用できます。

4. 管理者として **Windows PowerShell** を開きます。

5. **Azure AD Preview モジュール**をインストールする
	PowerShell ウィンドウで、次のコマンドレットを入力して **Enter** キーを押します。信頼されていないリポジトリのインストールを確認するために **Y** を入力して **Enter** キーを押します。

-  Microsoft Powershell コマンド:
  ```Install-Module -Name AzureADPreview```
 
- Microsoft Graph Powershell コマンド:
```Install-Module Microsoft.Graph.Beta```

6. AAD テナントに接続します。
 PowerShell ウィンドウで次のコマンドレットを入力し、**Enter** キーを押します。サインインウィンドウで、グローバル管理者 - MOD Administrator(admin@&lt;YourTenant&gt;.onmicrosoft.com) としてサインインします。
	   
-  Microsoft Powershell コマンド:
 ```Connect-AzureAD```

- Microsoft Graph Powershell コマンド:
```Connect-MgGraph```
	
7. 次のコマンドレットを使用して、Azure AD 統合グループテンプレートを読み込みます:
          
-	Microsoft Powershell コマンド:
  ```$Template = Get-AzureADDirectorySettingTemplate | Where {$_.DisplayName -eq "Group.Unified"}```
	
8. Azure AD 設定が既に存在するかどうかを確認し、存在する場合は読み込みます。存在しない場合は、空白の Azure AD 設定オブジェクトを作成します。次のコマンドレットを実行して、"$Setting" 変数に値を設定します:
   
- Microsoft Powershell コマンド:
   ```if(!($Setting = Get-AzureADDirectorySetting | Where {$_.TemplateId -eq $Template.Id})) {$Setting = $Template.CreateDirectorySetting()}```

9. 次のコマンドレットを実行して、"EnableGroupCreation" 属性でテナントのグループ作成設定を変更します:

-  Microsoft Powershell コマンド:
  ```$Setting["EnableGroupCreation"] = "False"```
   
-  Microsoft Graph Powershell コマンド:
  ```Update-MgDirectorySetting -DirectorySettingId $Setting.Id -Values @{ "EnableGroupCreation" = "False" }```
	
10. 次のコマンドレットを実行して、ObjectID によって、作成したばかりのセキュリティグループ **GroupCreators** をグループを作成できる許可されたグループとして追加します:

-  Microsoft Powershell コマンド:
  ```$Setting["GroupCreationAllowedGroupId"] = (Get-AzureADGroup -SearchString "GroupCreators").objectid```

11. 次のコマンドで構成した変更を確認します:

- Microsoft Powershell コマンドおよび Microsoft Graph Powershell コマンド:
```$Setting.Values```

11. 変更を保存し、設定を適用します:

-  Microsoft Powershell コマンド:
  ```New-AzureADDirectorySetting -DirectorySetting $Setting```
       
    **注:** これは新しいテナントであるため、テナントにはまだディレクトリ設定オブジェクトがありません。最初にディレクトリ設定オブジェクトを作成するには、```New-AzureADDirectorySetting``` を使用する必要があります。
	
12. 新しく構成された設定をテストします。

    1. 提供された資格情報を使用して **Client 2 VM** に接続します。

    2. Teams デスクトップクライアントから **Alex Willber** としてテストし、**Teams とチャネル** > **...** > **Teams とチャネル** に移動し、**チームの作成**の横のドロップダウンボタンを選択すると、**チームの作成**と**チームに参加**のオプションがあることに注意してください。

    3. Teams Web クライアントから **Lynne Robbins** としてテストし、上記と同じ手順に従うと、**チームに参加**オプションのみが利用可能であることに注意してください。

        **注:** 新しいチームを作成できる場合は、新しい構成がユーザーに反映されるまで数分待ってください。


13. ユーザーが新しいチームを作成できるようにするための変更を元に戻します。

14. **Windows PowerShell** を開いている **Client 1 VM** に接続します。
    
15. 次のコマンドレットを使用して、Azure AD 統合グループテンプレートを読み込みます:

- Microsoft Powershell コマンド:
  ```$Template = Get-AzureADDirectorySettingTemplate | Where {$_.DisplayName -eq "Group.Unified"}```
 
16.	空白の Azure AD テナント設定オブジェクトを作成します:

-  Microsoft Powershell コマンド:
  ```$Setting = $Template.CreateDirectorySetting()```
      
17. 構成された設定を適用して、以前の変更を元に戻します:

-  Microsoft Powershell コマンド:
   ```Set-AzureADDirectorySetting -Id (Get-AzureADDirectorySetting | where {$_.DisplayName -eq "Group.Unified"}).id -DirectorySetting $Setting```

18.   PowerShell ウィンドウで、次のコマンドレットを入力して、Azure Active Directory テナントから現在のセッションを切断します。
-  Microsoft Powershell コマンド:
```Disconnect-AzureAD```
	
20. PowerShell ウィンドウを閉じて、次のタスクに進みます。
	
	
このタスクでは、新しいセキュリティグループを正常に作成し、このグループのメンバーのみに新しいグループの作成を制限するように Azure AD 設定を構成しました。タスクの最後に、後の演習でユーザーがチームを作成できるように、構成を元に戻しました。

#### タスク 3 - 新しい名前付けポリシーを構成する

Teams 計画プロジェクトの一環として、各新しい Microsoft 365 グループまたはチームがオブジェクトの命名に関する組織の規制に準拠する必要がある名前付けポリシーを構成します。各グループ名は、**Group_** というプレフィックスで始まり、グループを作成したユーザーの**国または地域**というサフィックスで終わる必要があります。

1. Client1 VM に接続し、**MOD Administrator** として Entra 管理センター (https://entra.microsoft.com/) を参照します。

2. **Contoso** の下のメインページで、**グループの表示** > **すべてのグループ**を選択します。

3. **グループ**ページで、設定の下の左側のメニューから **名前付けポリシー**を選択します。

4. **ブロックされた単語**を構成する

    1. **グループ | 名前付けポリシー**ページの **ブロックされた単語**タブで、**ダウンロード**を選択してサンプルファイルをダウンロードします。
    
    2. ダウンロードしたファイル **BlockedWords.csv** に移動して右クリックし、**プログラムから開く** > **メモ帳**を選択します。

    3. メモ帳ウィンドウの空の引用符を置き換えて **CEO,Payroll,HR** と入力し、ファイルを保存します。
    
    4. **グループ | 名前付けポリシー**ページに戻り、**3. .csv ファイルをアップロードする**の下で **ファイルを選択**ボックスまたはフォルダーアイコンを選択して、保存した .csv ファイルをアップロードします。

    5. **保存**を選択して、新しいブロックされた単語の設定を適用します。

5. **グループ名前付けポリシー**を構成する
    
    1. **グループ | 名前付けポリシー**ページで、**グループ名前付けポリシー**タブを選択します。

    2. **Group_** 文字列をプレフィックスとして追加する
        
        1. **プレフィックスのタイプを選択**のドロップダウンメニューを選択し、**文字列**を選択します。
        2. **プレフィックスを追加**チェックボックスをオンにします。
        3. テキストボックスに **Group_** と入力します。

    3. **国または地域**文字列をサフィックスとして追加する
        
        1. **サフィックスのタイプを選択**のドロップダウンメニューを選択し、**文字列**を選択して、テキストボックスに **_** と入力します。
	2. **サフィックスを追加**チェックボックスをオンにします。
        3. **別のサフィックスを選択**のドロップダウンメニューを選択し、**属性**を選択して、ドロップダウンメニューから **国または地域**を選択します。
        
    4. **保存**を選択して、新しいブロックされた単語の設定を適用します。


このタスクでは、Microsoft 365 グループ名で使用される特定の単語をブロックする名前付けポリシーを構成し、Microsoft 365 グループの名前に新しい名前付けポリシーを構成しました。

#### タスク 4 - 新しい名前付けポリシーをテストする

パイロット環境での効果を確認するために、新しく作成された名前付けポリシーをテストする必要があります。次のタスクでは、新しいチームを作成しようとし、構成された名前付けポリシーテンプレートがグループ名とエイリアスに適用されることを確認します。

**注:** ブロックされた単語の設定が有効になるまでに最大 24 時間かかる場合があります。したがって、すぐに有効になる構成された名前付けポリシーのみをテストします。

1. **Client 2 VM** に接続し、**Alex Wilber** (AlexW@&lt;YourTenant&gt;.onmicrosoft.com) として **Teams デスクトップクライアント** (https://teams.microsoft.com/) を開きます

2. Teams デスクトップクライアントで、左側のメニューから **Teams とチャネル**を選択 > **...** > **Teams とチャネル**を選択します。

3. 左上隅の **チームの作成**を選択して、チームとチャネルを作成して参加します。

4. **チームの作成**を選択 >**チーム名**に **Afterwork** を入力 > **説明**に何でも入力 > チームタイプを **パブリック**に設定 > 最初のチャネルに名前を付けるために **Afterwork** を入力します。
   
	入力した名前の下に、新しいチーム用に構成されたプレフィックスとサフィックスが表示されます。

5. **作成**を選択して新しいチームを作成します。

6. チームメンバーに **Lynne Robbins** を追加します。

7. 新しく作成されたチームの名前を確認します。

ユーザーが作成したチームのプレフィックスとサフィックスを管理するための名前付けポリシーを正常にテストしました。

#### タスク 5 - 名前付けポリシーを削除する

テスト後に名前付けポリシーを削除できます。次のタスクでは、作成したばかりの名前付けポリシーを削除します。

1. Client1 VM に接続し、**MOD Administrator** として Entra 管理センター (https://entra.microsoft.com/) を参照します。

2. **Contoso** の下のメインページで、**グループの表示** > **すべてのグループ**を選択します。

3. **グループ名前付けポリシー**タブに移動します。

5. 上部のリボンで **ポリシーの削除**を選択 > **はい**を選択します。

#### タスク 6 – ポリシーパッケージを管理する

さまざまなユーザーグループの多数のポリシーを個別に管理する管理オーバーヘッドを回避するために、ポリシーパッケージを使用してポリシーを論理単位にグループ化することを評価する必要があります。このタスクでは、既存のポリシーパッケージを変更してユーザーに割り当てます。

1. **Client 1 VM** に接続し、**Joni Sherman** (JoniS@&lt;YourTenant&gt;.onmicrosoft.com) として Teams 管理センター (https://admin.teams.microsoft.com) を参照します。

2. Teams 管理センターの左側のナビゲーションで、**ポリシーパッケージ**を選択します。

3. **ポリシーパッケージ**ページで、**Frontline worker (default)** ポリシーパッケージを選択します。

	![Table Description automatically generated](media/MS-700-lab_M03_ak_image7.png)

4. **Frontline Worker (Default)** の横のボックスをチェックし、ナビゲーションリボンから **ユーザーの管理**を選択します。
   
5. **"Joni"** を検索し、ドロップダウンから **追加**を選択します。次に、下部の **適用**を選択します。
   
6. 左側のナビゲーションで、**ユーザー**を選択してから **ユーザーの管理**を選択します。
   
7. ユーザーのリストから **Joni Sherman** を選択します。
   
8. **ポリシー タブ**に移動し、**メッセージングポリシー**の横にある **Frontline_Worker** を選択します。

9. **優先度通知を使用して緊急メッセージを送信する**設定をオンにして **保存**を選択します（この設定がまだオンになっていない場合）。

10. **確認**を押します。

12. **Frontline worker** ポリシーパッケージで通話ポリシーを更新します。

	1. **ポリシーパッケージ**ページに戻ります。
	2. リストから再度 **Frontline worker (default)** を選択します。
	3. **通話ポリシー**の右側にある **Frontline_worker** を選択します。
	4. **通話料金のバイパスを防ぎ、PSTN 経由で通話を送信する**設定を**オン**にします。
	5. **通話中にビジー**を **オン**に更新します。
	6. **保存**を選択します。
    	7. **確認**を選択します。

13. 左側のナビゲーションペインから **ポリシーパッケージ**に移動します。

14. **Frontline worker** ポリシーパッケージがチェックされていることを確認します。

15. 上部のメニューから **ユーザーの管理**を選択します。

16. 検索ボックスに **Allan** と入力し、**Allan Deyoung** の右側の **追加**を選択して **適用**します。

17. ポリシーの割り当てを確認します。

	1. 左側のペインから **ユーザー** > **ユーザーの管理**を選択します。

	2. **Allan Deyoung** を選択し、**ポリシー**タブを選択します。

	3. ポリシーパッケージセクションの下に **Frontline worker (Direct)** が表示されます。

既存のポリシーパッケージに含まれるポリシーを正常に変更し、パッケージを単一のユーザーに割り当てました。これにより、同じ役割で働くユーザーのグループに同じポリシーセットを割り当てることができます。
 

### **演習 5: Teams 更新ポリシーを使用して Teams パブリックプレビュー機能へのアクセスを有効にする**

この演習では、Teams 更新ポリシーを使用して、今後の機能を調査および評価するようにユーザーを構成します。パブリックプレビューはユーザーごとに有効にされ、更新ポリシーは Teams で Teams プレビューとリリース前の機能を表示するユーザーを管理するために使用されます。

#### タスク 1 - カスタム更新ポリシーを作成する

1. **CLIENT1 VM** に接続し、**Joni Sherman** ([JoniS@&lt;YourTenant&gt;.onmicrosoft.com](mailto:JoniS@M365x19242873.onmicrosoft.com)) として **Teams 管理センター** [https://admin.teams.microsoft.com](https://admin.teams.microsoft.com) を参照します。

	**注:** 別の資格情報でログインするには、Microsoft Edge の **InPrivate ウィンドウ**を使用できます。

2. Teams 管理センターの左側のナビゲーションで、**Teams** > **Teams 更新ポリシー**を選択します。

3. **...** > **+ 追加**を選択します

4. 次の情報を入力します:

	- 名前: **プレビュー機能を有効にする**
	- 説明: **Teams パブリックプレビューを有効にする**
	- プレビュー機能を表示: **すべてのユーザーに対してオン**を選択
	- **適用**を選択

これで、カスタム **Teams 更新ポリシー**の作成が完了しました。
 

#### タスク 2 - カスタム更新ポリシーをユーザーに割り当てる

グローバルポリシーを上書きしないため、カスタム更新ポリシーを特定のユーザーに割り当てる必要があります。

1. **Teams 管理センター** > **Teams** > **Teams 更新ポリシー**に移動します。

2. カスタム更新ポリシー **プレビュー機能を有効にする**を選択します。

3. **ユーザーの割り当て**を選択します。

4. 次のパイロットユーザーを検索して、**追加**を選択します:

	* Alex Wilber 
	* Lynne Robbins 
	* Diego Siciliani 

5. **適用**を選択してから **確認**を選択して、タスク 1 で作成したカスタム更新ポリシーを割り当てます。

ラボの終了
